<!DOCTYPE html>
<html>
<head>
    {{template "sysmanage/aalayout/meta.tpl" .}}
</head>
<body>
<div class="layui-fluid">
    <div class="layui-row layui-col-space10">
        <div class="layui-col-xs12 layui-col-sm12 layui-col-md12">
			<!--tab标签-->
			<div class="layui-tab layui-tab-brief">
				<ul class="layui-tab-title">
					<li class="layui-this">客服列表</li>
				</ul>
				<div class="layui-tab-content">
					<form class="layui-form layui-form-pane" action='{{urlfor "CustomerIndexController.get"}}' method="get">
						<div class="layui-inline">
							<div class="layui-input-inline">
								<input type="text" name="username" value="{{.condArr.username}}" placeholder="用户名" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<button class="layui-btn"><i class="layui-icon layui-icon-search layuiadmin-button-btn"></i></button>
						</div>
					</form>
					<hr>
					<div class="layui-tab-item layui-show">
						<table class="layui-table">
							<thead>
							<tr>
								<th>ID</th>
								<th>用户名</th>
								<th>名称</th>
								<th>操作</th>
							</tr>
							</thead>
							<tbody>
							{{range $index, $vo := .dataList}}
								<tr>
									<td>{{$vo.Id}}</td>
									<td>{{$vo.Username}}</td>
									<td>{{$vo.Name}}</td>
									<td>
										<a href='{{urlfor "CustomerEditController.get" "id" $vo.Id}}' class="layui-btn layui-btn-normal layui-btn-xs">编辑</a>
									</td>
								</tr>
							{{else}}
								{{template "sysmanage/aalayout/table-no-data.tpl"}}
							{{end}}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{{template "sysmanage/aalayout/footjs.tpl" .}}
<script>
    layui.use('layer', function(){
        var $ = layui.jquery;

        $('.ajax-setLoginVerify').on('click', function () {
            var loadi = layer.load();
            var id = $(this).attr('data-id');
            $.ajax({
                url: '{{urlfor "AdminIndexController.LoginVerify"}}',
                type: "post",
                data: {'id':id,'type':'send'},
                success: function (info) {
                    if (info.code === 1) {
                        layer.prompt({
                            title: '输入验证码(邮件:Phage(富吉))',
                            offset: '200px'
                        }, function(value, index, elem){
                            $.ajax({
                                url: '{{urlfor "AdminIndexController.LoginVerify"}}',
                                type: "post",
                                data: {'id':id,'type':'verify','code':value},
                                success: function (info) {
                                    if (info.code === 1) {
                                        setTimeout(function () {
                                            location.href = info.url || location.href;
                                        }, 1000);
                                        layer.msg(info.msg, {icon: 1});
                                    } else {
                                        layer.msg(info.msg, {icon: 2});
									}
                                }
                            });
                            layer.close(index);
                        });
                        layer.msg(info.msg, {icon: 1});
                    } else {
                        layer.msg(info.msg, {icon: 2});
					}
                },
                complete: function () {
                    layer.close(loadi);
                }
            });

            return false;
        });

    });
</script>
</body>
</html>
